{{ define "header" }}
// Code generated by ModelQ using a self defined template fragments

package {{.PkgName}}

import (
	"encoding/json"
	"encoding/gob"
	"fmt"
	"strings"
	"database/sql"
	{{if .ImportTime}}"time"{{end}}
)
{{ end }}

{{ define "struct" }}
type {{.Name}} struct {
	{{range .Fields}}{{.Name}} {{.Type}} {{.JsonMeta}}
	{{end}}
}
{{ end }}

{{ define "obj_api" }}
func (obj {{.Name}}) String() string {
	if data, err := json.Marshal(obj); err != nil {
		{{if .PrimaryField}}return fmt.Sprintf("<{{.Name}} {{.PrimaryField.Name}}=%d>", obj.{{.PrimaryField.Name}}){{else}}return fmt.Sprintf("<{{.Name}}>"){{end}}
	} else {
		return string(data)
	}
}
{{ end }}

{{ define "query_api" }}
{{ end }}

{{ define "managed_api" }}
func init() {
	gob.Register({{.Name}}{})
}
{{ end }}
